---
sort: 7
title: 'Lesson 7: Present Step'
---


---
## Prompt

```markdown
## Execution instruction ##
  - **Hotel founded JSON** 
    - {{HOTEL_FOUND_INFO}}
  
  - **Presenting Found Hotels**
    - Must use data from `Hotel founded JSON` section, present to user each item's `hotelName` , `total` in `Hotel founded JSON` list in numbered bullet form, and ask user to pick a number.
    - the `total` must be formatted in U.S. currency, and display "total price is: `total`"

  - **Subsequent Choices After Hotel Presentation**
    - While you are presenting the list of found hotels to be picked, tell user they can 
      a. book a hotel by typing name or number presented above.
        - if user choose to book hotel, call tool `chosen_hotel`
      b. re-run the entire search 
        - If user choose to re-run the search, immediately call tool `search_again`
        - Examples:
          - re-run search
          - search again
          - change room type to one bed/two beds/suite
          - add amenities tennis court
          - remove amenities indoor pool
          - change distance to airport to 10 miles.
          - remove distance to city center.
          - I want to see what criteria I have chosen
          - I want to re-enter search criteria
          - show preferences
      c. compare hotel features
        - If user choose to compare features of hotel, call tool `go_compare`
        - Examples:
          - compare hotel
          - compare hotel feature
          - compare <Hotel A> and <Hotel B>
          - compare all Hotels on list
          - compare <Hotel A> vs. <Hotel B>
          - compare <Hotel A> vs. <Hotel B>
```
---
## Code

```javascript
const PresentPrompt = Prompt.file('prompt/present.md');
export class PresentStep extends Step {
  constructor(flow: Flow, isActive?: boolean) {
    super(PresentStep, flow, isActive);
  }

  protected onActivate(flag: boolean) {
    if (flag) {
      this.eraseMemory();
    }
  }

  public onCrossStep(_langMessage: MessageTypes): MessageTypes {
    return new HumanMessageExt(this, 'What hotels choice I have');
  }

  public getPrompt(): string {
    const hotelFoundInfo = this.getState('hotelFound') as SearchHotelEntry;

    const prompt = Prompt.replace(PresentPrompt, {
      HOTEL_FOUND_INFO: JSON.stringify(hotelFoundInfo),
    });

    return prompt;
  }

  public defineTool(): ToolType[] {
    return [
      {
        name: 'chosen_hotel',
        description: 'Capture user choice of hotel',
        schema: z.object({
          hotelName: z.string().describe('Hotel name chosen'),
        }),
      },
      {
        name: 'search_again',
        description: 'User request to re-run the search hotel again',
        schema: z.object({
          isSearch: z.boolean().describe('run the search'),
        }),
      },
      {
        name: 'go_compare',
        description: 'User request compare hotel',
        schema: z.object({
          isCompare: z.boolean().describe('go compare the hotels'),
        }),
      },
    ];
  }
  public getTool(): string[] {
    return ['chosen_hotel', 'search_again', 'go_compare'];
  }

  protected async chosen_hotel(
    tool: ToolCall,
    _langMessage: MessageTypes,
  ): Promise<MessageTypes> {
    this.setState({ hotel: tool.args?.hotelName });
    const msg = `Tell user hotel is booked with confirmation #:${this.generateConfirmationNumber()}. Thank the user for choosing Hilton, you MUST NOT talk other things!`;
    this.flow.activate(EndStep, { prompt: msg });
    return null;
  }

  protected async search_again(
    _tool: ToolCall,
    langMessage: MessageTypes,
  ): Promise<MessageTypes> {
    this.flow.activate(ExploreStep);
    return langMessage;
  }

  protected async go_compare(
    _tool: ToolCall,
    _langMessage: MessageTypes,
  ): Promise<MessageTypes> {
    const availableHotel = this.flow.getStepState(
      PresentStep,
      'hotelFound',
    ) as [];

    const strAvailableHotel = availableHotel.map((entry) => {
      return entry['hotelName'];
    }) as string[];

    this.flow.activate(CompareStep, {
      replaceState: [
        'available_hotel',
        {
          available_hotel: strAvailableHotel,
        },
      ],
    });

    return null;
  }

  private generateConfirmationNumber(): number {
    return Math.floor(100000 + Math.random() * 900000);
  }
}
```
---
## Wrapping up
